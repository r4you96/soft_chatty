# SoftChatty

### 요구 사항 구현 여부

1. 실시간 채팅

   - [x] 사용자는 제목을 포함하여 채팅방을 생성할 수 있습니다.
   - [x] 사용자는 1명 이상의 사용자와 실시간으로 채팅할 수 있습니다.
   - [x] 메시지는 실시간으로 전송되어야 하며, 
     채팅 참여자가 채팅방의 이전 모든 메시지와 새로운 메시지를 볼 수 있습니다.
   - [x] 사용자는 30분 내 접속자 수를 알 수 있습니다.

2. 30분 내 접속자 수 기준으로 채팅 목록 정렬

   - [x] 채팅 목록은 30분 내에 접속한 사용자 수의 내림차순으로 정렬됩니다.

3. 채팅 목록에 최근 메시지 노출

   - [x] 채팅 목록에는 해당 채팅방의 가장 최근 메시지가 노출됩니다.

   - [ ] 최근 메시지는 실시간으로 업데이트되어야 하며, 
     새로운 메시지가 도착할 때마다 자동으로 변경되어야 합니다.

4. 데이터베이스 관리

   - 데이터베이스 구조는 효율적이고 확장 가능해야 합니다.
   - 2개 이상의 데이터베이스를 사용해도 무관합니다.

5. 사용자 관리

   - [x] 각 사용자는 고유한 식별자(ID)를 가지고 있어야 합니다.

   - 회원가입 및 로그인은 구현하지 않아도 되며, 임의의 사용자 ID가 있다고 가정합니다.

## 실행법

- 서버 : `repository root folder`의 `run_server.py`를 실행
- 클라이언트 : `repository root folder`의 `run_client.py`를 실행

### config

`repository root folder`의 `config` 폴더에서 수정
수정이 필요할 수 있는 필드들은 다음과 같음.

- server
  - mongo_url : mongodb url
  - mongo database : mongo database
  - mongo authsource : mongo authsource
- client 
  - socket_url : 서버 url(로컬에서 실행한다면 변경하지 않아도 됨)

## 클라이언트 사용법

클라이언트는 터미널에서 사용자 입력 및 표준 출력을 통해 사용된다.
각각의 기능은 사용하고자 하는 기능을 전치사로 붙이고
뒤로 붙인 값은 해당 이벤트에서 사용할 값이 된다.

각 전치사는 다음과 같다.

- 메시지 전송 : `msg {전송할 메시지 내용}`
- 채널 목록 갱신 : `show_channels`
- 채널 생성 : `create_channel {생성할 채널 이름}`
- 채널 오픈 : `open_channel {오픈할 채널 이름}`
- 채널 클로즈 : `close_channel` (현재 오픈된 채널이 있는 경우 닫힘)
- 클라이언트 종료 : `close`

## 가정

### 주요 동작

- 유저는 한번에 하나의 채널에 접속할 수 있음
- 채널에 접속된 상태에서 다른 채널에 접속하면 이전 채널에서의 접속은 종료됨
- 클라이언트를 종료하면 접속되어있던 채널을 close

### 제약 사항

- 같은 이름의 채널은 생성할 수 없음

### 활성 유저 계산

다음 두 값을 합산

- 현재 해당 채널을 open중인 유저 집계
- 현재 해당 채널을 close했으며 close 시점이 30분 이내인 유저 집계
